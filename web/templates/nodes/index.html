{% extends 'layout.html' %}

{% set menuid = 'nodes' %}

{% block title %}所有节点{% endblock %}

{% block head %}
<style type="text/css">
    .status-column.state-0 {
        color: red;
    }
    .status-column.state-1 {
        color: green;
    }
</style>
<script type="text/javascript">
    var getSelectBox = function(){
        return $("#node_form").find("input[name^=ids]:checked");
    }
    $(function(){
        $(".advance_search").toggle(
            function() {
                $(".advance_search_form").show();
                $(this).addClass("hidedetail");
            },
            function() {
                $(".advance_search_form").hide();
                $(this).removeClass("hidedetail");
            }
        )
        $("#advance_search").click(function() {
            search_form = $("#search_form");
            search_form.attr("action","{{url_for('nodes.nodes')}}").submit();
        })
        node_form = $("#node_form");
        $("#delete_btn").click(function() {
            var ids = getSelectBox();
            if(ids.length > 0){
                if(confirm("确认删除这些节点？")) {
                    node_form.attr("action","{{url_for('nodes.node_delete')}}").submit();
                }
            }else{
                alert("请选择节点");
            }
        })
    })
</script>
{% endblock %}

{% from "_table_h.html" import render_table, render_screen_meta %}

{% block screen_meta %}

{{ render_screen_meta(table) }}

<div id="screen-meta-links">
    <div id="contextual-help-link-wrap" class="hide-if-no-js screen-meta-toggle">
        <a href="#contextual-help-wrap" id="contextual-help-link"
        class="show-settings">Help</a>
    </div>
    <div id="screen-options-link-wrap" class="hide-if-no-js screen-meta-toggle">
        <a href="#screen-options-wrap" id="show-settings-link"
        class="show-settings">Screen Options</a>
    </div>
</div>

{% endblock %}

{% block content %}

<div class="row-fluid"  style="margin-top:30px">
    <div class="span2">
        {% set submenuid = 'nodes' %}
        {% include 'nodes/_sidebar.html' %}
    </div>
    <div class="span10">
        {% include "_alert.html" %}
        <form class="form-horizontal" method="GET" action="{{url_for('nodes.nodes')}}" id="search_form">
            <div class="tablenav top">
                <div class="alignleft">
                    <input type="hidden" name="orderby" value="login">
                    <input type="hidden" name="order" value="asc">
                    <div class="alignleft btn-group">
                        <a class="btn btn-small" href="/nodes/new">新建</a>
                        <a class="btn btn-small" href="#" id="delete_btn">删除</a>
                        <a class="btn btn-small" href="#">规划</a>
                        <a class="btn btn-small" href="#">更新规则</a>
                    </div>
                </div>
                <div class="alignleft form-search" style="height: 26px;">
                        {% set keyword = '<IP>' %}
                        <div class="input-append alignleft" style="margin-left: 20px;">
                            {{ form.ip(placeholder=keyword,class="input-low") }}
                            <button id="advance_sarch" class="btn btn-small">确定</button>
                        </div>
                        <div class="alignleft advance_search" title="高级检索"></div>
                </div>
            </div>
            {% include "nodes/_search_form.html" %}
        </form>
        <form action="" method="POST" id="node_form">
        {{ render_table(table) }}
        </form>
        <br class="clear">

    </div>
</div>

{% endblock %}
