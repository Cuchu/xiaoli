{% extends 'layout.html' %}

{% block head %}
    <link rel="stylesheet" href="/static/css/node.css" type="text/css" media="screen" />
    <script type="text/javascript">
        var getSelectBox = function(){
            return $("#node_form").find("input[name^=id]:checked");
        }
        $(function(){
            $(".advance_search").toggle(
                    function() {
                        $(".advance_search_form").show();
                        $(this).addClass("hidedetail");
                    },
                    function() {
                        $(".advance_search_form").hide();
                        $(this).removeClass("hidedetail");
                    }
            )
            $(".btn_advance_search").click(function() {
                search_form = $("#search_form");
                search_form.attr("action","{{url_for('nodes.switches')}}").submit();
            })
            var node_form = $("#node_form");
            $(".delete").click(function() {
                if(confirm("确认删除此节点？")) {
                    var input = $(this).parent().parent().next();
                    input.attr({checked: "checked"});
                    $("body").append('<form id="delete_'+input.val()+'" method="POST" action="'+ $(this).src+'"></form>')
                    $("#delete_"+input.val()).attr("action",$(this).attr("href")).append(input.clone()).submit();
                }
                return false;
            })
        })
    </script>
    {{ form.media.render() }}
{% endblock %}

{% from "_table_h.html" import render_table, render_screen_meta %}

{% block screen_meta %}

    {{ render_screen_meta(table) }}

{% endblock %}

{% block content %}

    <div class="row-fluid content">
        <div class="span2">
            {% set menuid = 'nodes' %}
            {% include 'nodes/_sidebar.html' %}
        </div>
        <div class="span10">
            {% include "_alert.html" %}
            <ul id="status_statistics">
                {% for status in status_statistcs %}
                    <li class="status-{{ status.status }}">{{ status.name }}<span class="count">({{ status.number }})</span></li>
                {% endfor %}
            </ul>
            <form class="form-horizontal" method="GET" action="{{url_for('nodes.nodes')}}" id="search_form">
                <div class="tablenav top">
                    <div class="pull-left" style="height: 26px;">
                        {% set keyword = '名称、别名或IP' %}
                        <div class="input-append pull-left">
                            {{ form.name(placeholder=keyword,class="input-low input-medium") }}
                            <button class="btn btn-small btn_advance_sarch">检索</button>
                        </div>
                        <div class="pull-left advance_search" title="高级检索"></div>
                    </div>
                    <div class="pull-right actions">
                        <a class="btn btn-small" href="#" title="Excel导出"><i class="icon-download-alt"></i></a>
                    </div>
                </div>
                {% from "_form_h.html" import render_search_form %}
                {{ render_search_form(form.area, form.vendor_id, form.model_id) }}
            </form>
            <form action="" method="POST" id="node_form">
                {{ render_table(table) }}
            </form>
            <br class="clear">
        </div>
    </div>

{% endblock %}
